<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Espace Gestionnaire - ManiocAgri</title>
    <!-- Fonts & Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Outfit:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link href="../bootstrap-5.3.8-dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="../style.css" rel="stylesheet">
    <style>
        :root {
            --admin-green: #198754;
            --admin-green-dark: #146c43;
            --sidebar-width: 280px;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fa;
        }

        .admin-sidebar {
            background: linear-gradient(135deg, #198754 0%, #146c43 100%);
            min-height: 100vh;
            color: white;
            box-shadow: 4px 0 10px rgba(0, 0, 0, 0.05);
        }

        .nav-link {
            color: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            margin: 4px 15px;
            padding: 12px 20px;
            transition: all 0.3s;
            font-weight: 500;
        }

        .nav-link:hover {
            color: white;
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-link.active {
            background: white !important;
            color: var(--admin-green) !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .main-content {
            padding: 2rem;
        }

        .stat-card {
            border-radius: 20px;
            border: none;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    </style>
</head>

<body>
    <div class="container-fluid p-0">
        <div class="row g-0">
            <!-- SIDEBAR -->
            <div class="col-auto">
                <div class="offcanvas-lg offcanvas-start admin-sidebar" id="sidebarMenu">
                    <div class="p-4 text-center">
                        <h4 class="fw-bold mb-0 text-white"><i class="fas fa-leaf me-2"></i>ManiocAgri</h4>
                        <p class="small opacity-75 mb-0">Gestionnaire Logistique</p>
                    </div>

                    <div class="nav flex-column nav-pills mt-4" id="v-pills-tab" role="tablist">
                        <button class="nav-link active border-0 text-start" id="nav-dash-tab" data-bs-toggle="pill"
                            data-bs-target="#tab-dash" type="button" role="tab">
                            <i class="fas fa-chart-line me-3"></i>Vue d'ensemble
                        </button>
                        <button class="nav-link border-0 text-start" id="nav-orders-tab" data-bs-toggle="pill"
                            data-bs-target="#tab-orders" type="button" role="tab">
                            <i class="fas fa-truck-loading me-3"></i>Commandes
                        </button>
                        <button class="nav-link border-0 text-start" id="nav-stocks-tab" data-bs-toggle="pill"
                            data-bs-target="#tab-stocks" type="button" role="tab">
                            <i class="fas fa-warehouse me-3"></i>Catalogue & Stocks
                        </button>
                        <button class="nav-link border-0 text-start" id="nav-users-tab" data-bs-toggle="pill"
                            data-bs-target="#tab-users" type="button" role="tab">
                            <i class="fas fa-users-cog me-3"></i>Utilisateurs
                        </button>

                        <hr class="mx-4 opacity-25">

                        <a class="nav-link border-0 text-start" href="../index.html">
                            <i class="fas fa-home me-3"></i>Retour au site
                        </a>
                        <button class="nav-link border-0 text-start text-danger" id="logoutBtn">
                            <i class="fas fa-sign-out-alt me-3"></i>Déconnexion
                        </button>
                    </div>
                </div>
            </div>

            <!-- MAIN CONTENT -->
            <main class="col">
                <!-- Header Mobile -->
                <nav class="navbar navbar-expand-lg d-lg-none bg-success navbar-dark p-3">
                    <div class="container-fluid">
                        <button class="navbar-toggler border-0" type="button" data-bs-toggle="offcanvas"
                            data-bs-target="#sidebarMenu">
                            <i class="fas fa-bars"></i>
                        </button>
                        <span class="navbar-brand ms-2 fw-bold">ManiocAgri</span>
                        <div class="dropdown">
                            <img src="https://ui-avatars.com/api/?name=Gestionnaire&background=fff&color=198754"
                                class="rounded-circle" width="35" alt="Profile">
                        </div>
                    </div>
                </nav>

                <div class="main-content">
                    <header class="d-flex justify-content-between align-items-center mb-5 d-none d-lg-flex">
                        <div>
                            <h2 class="fw-bold mb-1" id="pageTitle">Tableau de Bord</h2>
                            <p class="text-muted mb-0" id="currentDate">-- -- 2026</p>
                        </div>
                        <div class="d-flex align-items-center gap-3">
                            <div class="text-end me-2">
                                <h6 class="mb-0 fw-bold">Gestionnaire</h6>
                                <small class="text-success">En ligne</small>
                            </div>
                            <img src="https://ui-avatars.com/api/?name=Gestionnaire&background=198754&color=fff"
                                class="rounded-circle border" width="45" alt="Profile">
                        </div>
                    </header>

                    <div class="tab-content" id="v-pills-tabContent">
                        <!-- TAB: DASHBOARD -->
                        <div class="tab-pane fade show active" id="tab-dash" role="tabpanel">
                            <div class="row g-4 mb-5">
                                <div class="col-md-3">
                                    <div class="card stat-card bg-primary text-white shadow-sm h-100">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between">
                                                <div>
                                                    <h6 class="text-uppercase small opacity-75">Toutes les Commandes
                                                    </h6>
                                                    <h2 class="mb-0 fw-bold" id="totalOrders">0</h2>
                                                </div>
                                                <i class="fas fa-shopping-cart fa-2x opacity-25"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card stat-card bg-warning text-dark shadow-sm h-100">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between">
                                                <div>
                                                    <h6 class="text-uppercase small opacity-75">En Attente d'Action</h6>
                                                    <h2 class="mb-0 fw-bold" id="pendingOrdersStat">0</h2>
                                                </div>
                                                <i class="fas fa-clock fa-2x opacity-25"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card stat-card bg-info text-white shadow-sm h-100">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between">
                                                <div>
                                                    <h6 class="text-uppercase small opacity-75">Stocks Totaux (KG)</h6>
                                                    <h2 class="mb-0 fw-bold" id="totalStock">0</h2>
                                                </div>
                                                <i class="fas fa-warehouse fa-2x opacity-25"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card stat-card bg-danger text-white shadow-sm h-100">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between">
                                                <div>
                                                    <h6 class="text-uppercase small opacity-75">Alertes Rupture</h6>
                                                    <h2 class="mb-0 fw-bold">0</h2>
                                                </div>
                                                <i class="fas fa-exclamation-triangle fa-2x opacity-25"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="alert alert-success d-flex align-items-center rounded-4 border-0 shadow-sm p-4">
                                <i class="fas fa-info-circle fa-2x me-3"></i>
                                <div>
                                    <h5 class="mb-1 fw-bold">Console de Gestion</h5>
                                    <p class="mb-0 opacity-75">Bienvenue dans votre espace logistique. Gérez les
                                        attributions des livreurs et les stocks en temps réel.</p>
                                </div>
                            </div>
                        </div>

                        <!-- TAB: COMMANDES -->
                        <div class="tab-pane fade" id="tab-orders" role="tabpanel">
                            <div class="card border-0 shadow-sm rounded-4">
                                <div class="card-header bg-white border-0 pt-4 px-4">
                                    <h5 class="fw-bold mb-0">Assignation des Commandes</h5>
                                    <p class="text-muted small">Affectez les livreurs aux commandes validées</p>
                                </div>
                                <div class="card-body p-4">
                                    <div id="pendingOrdersValidation">
                                        <div class="text-center py-5">
                                            <i class="fas fa-spinner fa-spin fa-2x text-success mb-3"></i>
                                            <p>Chargement des commandes...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- TAB: STOCKS -->
                        <div class="tab-pane fade" id="tab-stocks" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h4 class="mb-0 fw-bold">Inventaire & Catalogue</h4>
                                <div class="input-group w-50 shadow-sm">
                                    <span class="input-group-text bg-white border-end-0"><i
                                            class="fas fa-search"></i></span>
                                    <input type="text" id="productSearch" class="form-control border-start-0"
                                        placeholder="Rechercher un produit..." onkeyup="filterProducts()">
                                </div>
                            </div>
                            <div id="productsList" class="row g-4">
                                <!-- Populated by JS -->
                            </div>
                        </div>

                        <!-- TAB: UTILISATEURS -->
                        <div class="tab-pane fade" id="tab-users" role="tabpanel">
                            <div class="row g-4">
                                <div class="col-lg-12">
                                    <div class="card border-0 shadow-sm rounded-4 mb-4">
                                        <div class="card-header bg-warning bg-opacity-10 border-0 pt-4 px-4">
                                            <div class="d-flex justify-content-between align-items-center">
                                                <h5 class="fw-bold mb-0 text-dark">Inscriptions à valider</h5>
                                                <span class="badge bg-warning text-dark px-3 rounded-pill"
                                                    id="pendingBadge">0</span>
                                            </div>
                                        </div>
                                        <div class="card-body p-4">
                                            <div id="pendingRegistrations">
                                                <!-- Populated by JS -->
                                            </div>
                                        </div>
                                    </div>

                                    <div class="card border-0 shadow-sm rounded-4">
                                        <div
                                            class="card-header bg-white border-0 pt-4 px-4 d-flex justify-content-between align-items-center">
                                            <h5 class="fw-bold mb-0">Comptes Approuvés</h5>
                                            <div class="input-group w-25 shadow-sm">
                                                <input type="text" id="userSearch" class="form-control form-control-sm"
                                                    placeholder="Rechercher..." onkeyup="filterUsers()">
                                            </div>
                                        </div>
                                        <div class="card-body p-0">
                                            <div id="usersList" style="max-height: 500px; overflow-y: auto;">
                                                <!-- Populated by JS -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modals (Copied from Admin if needed, or rely on script.js injected modals) -->

    <script src="../bootstrap-5.3.8-dist/js/bootstrap.bundle.min.js"></script>
    <script src="../script.js"></script>
    <script>
        // Update Title and Date
        document.getElementById('currentDate').textContent = new Date().toLocaleDateString('fr-FR', {
            weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
        });

        const tabPills = document.querySelectorAll('[data-bs-toggle="pill"]');
        tabPills.forEach(pill => {
            pill.addEventListener('shown.bs.tab', (event) => {
                const title = event.target.textContent.trim();
                document.getElementById('pageTitle').textContent = title;
            });
        });
    </script>
</body>

</html>